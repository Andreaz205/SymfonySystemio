# Symfony REST-приложение для расчета цены продукта и проведения оплаты

Для того что бы запустить приложение и заполнить бд необходимо выполнить набор команд:
1) make init
2) php bin/console doctrine:migrations:diff
3) php bin/console doctrine:migrations:migrate
4) php bin/console doctrine:fixtures:load

Реализованы 2 эндпоинта:
1. POST: для расчёта цены

http://127.0.0.1:80/calculate-price

Пример JSON тела запроса:
```
{
    "product": 1,
    "taxNumber": "DE123456789",
    "couponCode": "D15"
}
```
2. POST: для осуществления покупки

http://127.0.0.1:80/purchase

Пример JSON тела запроса:
```
{
    "product": 1,
    "taxNumber": "IT12345678900",
    "couponCode": "D15",
    "paymentProcessor": "paypal"
}
```

## Продукты

- Iphone (1000 евро)
- Наушники (2000 евро)
- Чехол (1500 евро)
- Зарядник (3000 евро)

## Купоны
Купоны позволяют применить скидку к покупке и могут быть двух типов:
- фиксированная сумма скидки
- процент от суммы покупки

## Расчет налога
Налог рассчитывается исходя из страны налогового номера и прибавляется к цене продукта:
- Германия - 19%
- Италия - 22%
- Франция - 20%
- Греция - 24%

Например, цена Iphone для покупателя из Греции составит 124 евро (100 евро + налог 24%). Если у покупателя есть купон на 6% скидку, то цена будет 116.56 евро (100 евро - 6% скидка + налог 24%).

## Формат налогового номера
Форматы налоговых номеров для разных стран:
- DEXXXXXXXXX - Германия
- ITXXXXXXXXXXX - Италия
- GRXXXXXXXXX - Греция
- FRYYXXXXXXXXX - Франция

где X - любая цифра от 0 до 9, Y - любая буква. Длина налогового номера различается в зависимости от страны.

## Начало работы
Для удобства выполнения и проверки задания предлагаем клонировать этот репозиторий. Это даст доступ к базовому Docker-контейнеру с необходимыми для задания компонентами. Для установки выполните `make init`, что запустит Symfony-приложение на порту 8337, смонтировав текущую директорию в контейнер.

Имейте в виду: контейнер предназначен для Linux и Mac. Для Windows потребуется WSL. Работая с нами, вы будете использовать контейнеры с аналогичными требованиями.